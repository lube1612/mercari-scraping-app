# メルカリとAmazonの価格比較（閲覧モード）実行手順

## 📋 概要

メルカリの商品を取得し、Amazonで同じ商品を検索して価格を確認します。
**Amazonのページはブラウザで開いて確認するだけ**（スクレイピングではなく閲覧モード）で動作します。

## 🎯 動作の流れ

1. **メルカリから商品情報を取得**
   - 検索キーワード: "ポケモンカード"
   - 最大10件の商品情報を取得

2. **Amazonの価格を確認（閲覧モード）**
   - 各商品について、Amazonの検索結果ページをブラウザで開く
   - 価格を確認（ページを「見る」だけの動作）
   - Amazonの方が高い場合のみ、その商品を選出

3. **結果を保存**
   - Amazonより安い商品を価格差が大きい順に5件選出
   - CSVファイルに保存

## 🚀 実行方法

**Cursorのターミナルで以下のコマンドを実行してください：**

```bash
cd /Users/shimadaeiji/Documents/Cursor/e2e
export PLAYWRIGHT_BROWSERS_PATH=~/playwright-browsers
python3 compare_with_amazon_view.py
```

## ⚠️ 注意事項

### 規約上のリスクについて

1. **閲覧モードの動作**
   - Amazonのページをブラウザで開いて価格を確認するだけ
   - スクレイピングではなく、ユーザーが手動でブラウザを開くのと同様の動作
   - ただし、完全に安全とは言えません

2. **推奨される使用方法**
   - 個人利用に限定
   - 過度なアクセスを避ける（リクエスト間に3秒以上の待機）
   - 商業利用は避ける

3. **より安全な方法**
   - Amazon Product Advertising APIの使用を推奨
   - または、手動でAmazonの価格を確認

## 📊 CSVファイルの内容

以下の情報が保存されます：
- `title`: 商品タイトル
- `price`: メルカリの価格
- `amazon_price`: Amazonの価格
- `price_difference`: 価格差
- `amazon_url`: Amazonの商品URL
- `url`: メルカリの商品URL

## 🔧 トラブルシューティング

### 問題1: Amazon価格が取得できない

**解決方法:**
- Amazonのサイト構造が変更されている可能性があります
- ブラウザでAmazonのページが正しく表示されているか確認してください
- 必要に応じて、手動で価格を確認してください

### 問題2: 価格のマッチングがうまくいかない

**解決方法:**
- 商品タイトルが異なる場合、同じ商品として認識されない可能性があります
- 検索キーワードの調整が必要な場合があります

## 📝 カスタマイズ

### 取得件数を変更する場合

`compare_with_amazon_view.py` の以下の部分を変更：

```python
cheaper_items = cheaper_items[:5]  # 最大5件
```

### 検索キーワードを変更する場合

`compare_with_amazon_view.py` の以下の部分を変更：

```python
search_keyword = "ポケモンカード"
```

## 🎯 実行例

```bash
$ python3 compare_with_amazon_view.py
============================================================
メルカリとAmazonの価格比較（閲覧モード）
============================================================
検索キーワード: ポケモンカード
取得件数: 5件（Amazonより安い商品）

⚠️  注意: Amazonのページはブラウザで開いて確認するだけです
   スクレイピングではなく、閲覧モードで動作します。

============================================================
1. メルカリから商品情報を取得中...
============================================================
...
（メルカリの商品情報取得）

============================================================
2. Amazonの価格を確認中（閲覧モード）...
============================================================
...
（Amazon価格確認）

============================================================
取得結果
============================================================
取得件数: 5件
CSVファイル: mercari/output/cheaper_than_amazon.csv

Amazonより安い商品:
  1. ラティアス&ラティオス GX RR SM9...
     メルカリ: ¥400 | Amazon: ¥600 | 差額: ¥200
  ...
```
