# メルカリスクレイピング実行手順（最終確認）

## ✅ 現在の状況

1. **Playwrightブラウザのインストール**: 完了 ✓
   - インストール場所: `~/playwright-browsers/`
   - Chromium: `chrome-mac-arm64` ✓
   - Headless Shell: `chrome-headless-shell-mac-arm64` ✓

2. **スクレイピングスクリプト**: 準備完了 ✓
   - `mercari/scrape.py`: 2件の商品情報を取得する設定

## 🚀 実行方法

**Cursorのターミナルで以下のコマンドを実行してください：**

```bash
cd /Users/shimadaeiji/Documents/Cursor/e2e
export PLAYWRIGHT_BROWSERS_PATH=~/playwright-browsers
python3 mercari/scrape.py
```

## 📋 実行時の動作

1. **ブラウザが起動**（headless=Falseなので、ブラウザウィンドウが表示されます）
2. **メルカリの検索結果ページにアクセス**
   - URL: `https://www.mercari.com/jp/search/?keyword=ポケモンカード`
3. **商品リンクを取得**
4. **2件の商品情報を取得**
   - 404エラーの場合は自動的にスキップ
   - 次の商品を試行
5. **CSVファイルに保存**
   - 保存先: `mercari/output/mercari_items.csv`

## 🔍 トラブルシューティング

### 問題1: ブラウザが見つからないエラー

**エラーメッセージ例:**
```
BrowserType.launch: Executable doesn't exist
```

**解決方法:**
環境変数を設定してから実行：
```bash
export PLAYWRIGHT_BROWSERS_PATH=~/playwright-browsers
python3 mercari/scrape.py
```

### 問題2: タイムアウトエラー

**エラーメッセージ例:**
```
Page.goto: Timeout 60000ms exceeded
```

**解決方法:**
- インターネット接続を確認
- しばらく待ってから再実行
- `mercari/scraper.py` の `wait_time` を増やす

### 問題3: 商品リンクが見つからない

**解決方法:**
- ブラウザウィンドウでページが正しく読み込まれているか確認
- クッキー同意ボタンが表示されている場合は手動でクリック
- ページの読み込みを待ってから再実行

## 📝 実行後の確認

実行が完了すると、以下のファイルに結果が保存されます：

```
mercari/output/mercari_items.csv
```

CSVファイルには以下の情報が含まれます：
- タイトル
- 価格
- 説明
- ポケモンカード情報（レアリティ、セット名、カード番号など）
- URL

## 🎯 まとめ

**実行コマンド（コピー&ペースト用）:**

```bash
cd /Users/shimadaeiji/Documents/Cursor/e2e && export PLAYWRIGHT_BROWSERS_PATH=~/playwright-browsers && python3 mercari/scrape.py
```

このコマンドを実行すれば、2件のポケモンカード情報が取得され、CSVファイルに保存されます。
